<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Depiline Spa - Sistema Admin</title>
  
  <!-- Fuente Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* ============================================
       1. VARIABLES (PALETA DEPILINE)
       ============================================ */
    :root {
      /* Brand Colors */
      --brand-olive: #B4B892;
      --brand-deep: #53583F;
      --brand-bronze: #735D3A;
      --brand-eggshell: #F0E9DD;
      --brand-coffee: #594B3C;
      --brand-sage: #809571;
      --brand-pearl: #E5E0D8;
      
      /* UI Tokens */
      --bg-app: #F9F9F9;
      --text-main: var(--brand-deep);
      --text-light: #666666;
      --border-color: rgba(83, 88, 63, 0.15);
      --radius-std: 10px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --shadow-soft: 0 4px 20px rgba(0,0,0,0.03);
    }

    /* ============================================
       2. ESTILOS BASE
       ============================================ */
    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
    body { font-family: 'Inter', sans-serif; background: var(--bg-app); color: var(--text-main); height: 100vh; overflow: hidden; }
    .hidden { display: none !important; }

    /* Botones */
    .btn { border: none; padding: 10px 20px; border-radius: var(--radius-std); cursor: pointer; font-weight: 500; transition: 0.2s; display: inline-flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.9rem; }
    .btn-primary { background: var(--brand-deep); color: white; }
    .btn-primary:hover { background: var(--brand-coffee); box-shadow: 0 4px 12px rgba(89, 75, 60, 0.3); }
    .btn-ghost { background: transparent; color: var(--text-light); }
    .btn-ghost:hover { background: rgba(0,0,0,0.05); color: var(--text-main); }
    
    /* Inputs */
    .input-std { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: var(--radius-std); margin-bottom: 12px; font-family: inherit; background: white; }
    .input-row { display: flex; gap: 10px; }

    /* Layout */
    .layout { display: grid; grid-template-columns: 260px 1fr; height: 100vh; }
    
    /* Sidebar */
    .sidebar { background: var(--brand-deep); color: white; display: flex; flex-direction: column; padding: 2rem; }
    .logo { font-size: 1.5rem; font-weight: 700; color: var(--brand-olive); margin-bottom: 3rem; display: flex; align-items: center; gap: 10px; cursor: pointer;}
    .nav { list-style: none; display: flex; flex-direction: column; gap: 8px; }
    .nav-btn { width: 100%; background: transparent; border: none; color: rgba(255,255,255,0.7); padding: 12px; text-align: left; font-size: 0.95rem; border-radius: var(--radius-std); cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 12px; }
    .nav-btn:hover { background: rgba(255,255,255,0.05); color: white; }
    .nav-btn.active { background: var(--brand-olive); color: var(--brand-deep); font-weight: 600; }

    /* Main Content */
    .content { padding: 2rem; overflow-y: auto; position: relative; }
    
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
    .profile-pill { background: white; padding: 6px 16px; border-radius: 50px; display: flex; align-items: center; gap: 12px; cursor: pointer; box-shadow: var(--shadow-soft); border: 1px solid var(--border-color); }
    .avatar { width: 36px; height: 36px; background: var(--brand-eggshell); color: var(--brand-bronze); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; overflow: hidden; }
    .avatar img { width: 100%; height: 100%; object-fit: cover; }

    /* ============================================
       3. ESTILOS ESPEC√çFICOS (DASHBOARD & FINANZAS)
       ============================================ */
    .section-view { display: none; animation: fadeIn 0.3s ease-out; }
    .section-view.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* Dashboard Cards */
    .dash-grid-kpi { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
    .kpi-card { background: white; padding: 20px; border-radius: var(--radius-lg); box-shadow: var(--shadow-soft); border: 1px solid var(--border-color); display: flex; flex-direction: column; position: relative; overflow: hidden; }
    .kpi-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; background: var(--brand-deep); }
    .kpi-card.accent-olive::before { background: var(--brand-olive); }
    .kpi-val { font-size: 1.8rem; font-weight: 700; color: var(--brand-deep); margin: 5px 0; }
    .kpi-label { font-size: 0.85rem; color: var(--text-light); text-transform: uppercase; letter-spacing: 0.5px; }

    /* Finanzas Espectacular */
    .fin-card { padding: 25px; border-radius: var(--radius-xl); color: white; position: relative; overflow: hidden; box-shadow: 0 10px 20px -5px rgba(0,0,0,0.15); }
    .fin-card.grad-1 { background: linear-gradient(135deg, var(--brand-deep), var(--brand-sage)); }
    .fin-card.grad-2 { background: linear-gradient(135deg, var(--brand-bronze), var(--brand-coffee)); }
    .fin-card.grad-3 { background: linear-gradient(135deg, #4A90E2, #5CA9F8); }
    
    .chart-container-large { background: white; padding: 25px; border-radius: var(--radius-xl); border: 1px solid var(--border-color); height: 400px; margin-bottom: 30px; box-shadow: var(--shadow-soft); }

    /* Agenda / Calendario */
    .calendar-wrapper { background: white; padding: 20px; border-radius: var(--radius-xl); border: 1px solid var(--border-color); }
    .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; }
    .cal-head { text-align: center; font-weight: 600; color: var(--text-light); padding: 10px 0; font-size: 0.9rem; }
    .cal-day { min-height: 120px; border: 1px solid #eee; border-radius: var(--radius-std); padding: 8px; transition: 0.2s; background: #fafafa; }
    .cal-day:hover { border-color: var(--brand-olive); background: white; }
    .cal-num { font-weight: 700; font-size: 0.9rem; margin-bottom: 5px; color: var(--brand-deep); }
    
    .appt-tag { font-size: 0.75rem; padding: 4px 6px; border-radius: 4px; margin-bottom: 4px; background: var(--brand-eggshell); color: var(--brand-bronze); border-left: 3px solid var(--brand-bronze); cursor: pointer; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}
    .appt-tag.vip { background: rgba(180, 184, 146, 0.3); border-left-color: var(--brand-olive); color: var(--brand-deep); }

    /* Modals & Login */
    .overlay { position: fixed; inset: 0; background: rgba(83, 88, 63, 0.6); z-index: 2000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(4px); }
    .overlay.open { display: flex; }
    .modal-box { background: white; padding: 2rem; border-radius: var(--radius-xl); width: 420px; animation: slideUp 0.3s; }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* Dashboard Charts Layout */
    .dash-charts-row { display: grid; grid-template-columns: 1.5fr 1fr; gap: 20px; margin-bottom: 30px; }
    .chart-box { background: white; padding: 20px; border-radius: var(--radius-xl); border: 1px solid var(--border-color); box-shadow: var(--shadow-soft); }

  </style>
</head>
<body>

  <!-- LOGIN -->
  <div id="login-overlay" class="overlay open" style="background: linear-gradient(135deg, var(--brand-deep), var(--brand-coffee)); z-index: 3000;">
    <div class="modal-box" style="text-align: center; width: 380px;">
      <h1 style="color:var(--brand-deep); margin-bottom:10px;">‚úø Depiline</h1>
      <p style="color:var(--text-light); margin-bottom:25px;">Gesti√≥n Administrativa</p>
      <form onsubmit="handleLogin(event)">
        <input type="text" class="input-std" placeholder="Usuario (admin)" required>
        <input type="password" class="input-std" placeholder="Contrase√±a (1234)" required>
        <button type="submit" class="btn btn-primary" style="width:100%">INICIAR SESI√ìN</button>
      </form>
    </div>
  </div>

  <!-- APP LAYOUT -->
  <div class="layout hidden" id="app-layout">
    
    <aside class="sidebar">
      <div class="logo" onclick="goTab('dashboard')"><span>‚úø</span> Depiline</div>
      <nav class="nav">
        <button class="nav-btn active" onclick="goTab('dashboard')" id="nav-dashboard"><span>üìä</span> Dashboard</button>
        <button class="nav-btn" onclick="goTab('agenda')" id="nav-agenda"><span>üìÖ</span> Agenda</button>
        <button class="nav-btn" onclick="goTab('clientes')" id="nav-clientes"><span>üë•</span> Clientes</button>
        <button class="nav-btn" onclick="goTab('finanzas')" id="nav-finanzas"><span>üí∞</span> Finanzas</button>
      </nav>
      <div style="margin-top: auto;">
        <button class="nav-btn" onclick="location.reload()"><span>üö™</span> Cerrar Sesi√≥n</button>
      </div>
    </aside>

    <main class="content">
      <header class="header">
        <div>
          <h2 id="page-title" style="color:var(--brand-deep)">Dashboard</h2>
          <p style="color:var(--text-light); font-size:0.9rem;">Resumen General</p>
        </div>
        <div class="profile-pill" onclick="openModal('profile')">
          <span style="font-size:0.9rem; font-weight:500;" id="user-display-name">Admin</span>
          <div class="avatar" id="user-avatar-display">AD</div>
        </div>
      </header>

      <!-- ================= VISTA DASHBOARD (Mantiene lo que te gust√≥) ================= -->
      <section id="view-dashboard" class="section-view active">
        <div class="dash-grid-kpi">
          <div class="kpi-card accent-olive">
            <div class="kpi-val">S/ 2,450</div><div class="kpi-label">Ventas Hoy</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-val">18</div><div class="kpi-label">Citas Agendadas</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-val">4</div><div class="kpi-label">Clientes Nuevos</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-val">98%</div><div class="kpi-label">Satisfacci√≥n</div>
          </div>
        </div>
        
        <div class="dash-charts-row">
          <div class="chart-box">
             <h4 style="margin-bottom:15px; color:var(--brand-deep)">Distribuci√≥n de Servicios</h4>
             <div style="height:250px; display:flex; justify-content:center;"><canvas id="chartServices"></canvas></div>
          </div>
          <div class="kpi-card" style="background: linear-gradient(135deg, var(--brand-deep), #3a3e2a); color:white; justify-content:center;">
             <div style="font-size:0.8rem; opacity:0.8; text-transform:uppercase;">Pr√≥xima Cita</div>
             <div style="font-size:3.5rem; color:var(--brand-olive); font-weight:300; margin:10px 0;">11:30</div>
             <div style="font-size:1.2rem; font-weight:600;">Luc√≠a Mendez</div>
             <div style="opacity:0.8;">Depilaci√≥n L√°ser ‚Ä¢ Cabina 3</div>
          </div>
        </div>
      </section>

      <!-- ================= VISTA AGENDA (Con funcionalidad + Nueva Cita) ================= -->
      <section id="view-agenda" class="section-view">
        <div class="calendar-wrapper">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 style="color:var(--brand-deep)">Calendario Diciembre 2025</h3>
            <button class="btn btn-primary" onclick="openModal('appointment')">+ Nueva Cita</button>
          </div>
          
          <div class="cal-grid" id="calendar-grid">
            <!-- JS GENERAR√Å LOS D√çAS AQU√ç -->
          </div>
        </div>
      </section>

      <!-- ================= VISTA FINANZAS (ESPECTACULAR RESTAURADO) ================= -->
      <section id="view-finanzas" class="section-view">
        <!-- 1. Tarjetas con Gradientes -->
        <div class="dash-grid-kpi" style="grid-template-columns: repeat(3, 1fr);">
           <div class="fin-card grad-1">
             <div style="font-size:0.9rem; opacity:0.9;">Ingresos Totales (Mes)</div>
             <div style="font-size:2.2rem; font-weight:700; margin-top:10px;">S/ 12,450</div>
             <div style="font-size:0.8rem; margin-top:5px; opacity:0.8;">‚Üë 15% vs mes anterior</div>
           </div>
           <div class="fin-card grad-2">
             <div style="font-size:0.9rem; opacity:0.9;">Gastos Operativos</div>
             <div style="font-size:2.2rem; font-weight:700; margin-top:10px;">S/ 4,200</div>
             <div style="font-size:0.8rem; margin-top:5px; opacity:0.8;">Insumos y Personal</div>
           </div>
           <div class="fin-card grad-3">
             <div style="font-size:0.9rem; opacity:0.9;">Ganancia Neta</div>
             <div style="font-size:2.2rem; font-weight:700; margin-top:10px;">S/ 8,250</div>
             <div style="font-size:0.8rem; margin-top:5px; opacity:0.8;">Rentabilidad saludable</div>
           </div>
        </div>

        <!-- 2. Gr√°fico Grande de √Årea -->
        <div class="chart-container-large">
           <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
             <h3 style="color:var(--brand-deep)">Evoluci√≥n Financiera 2025</h3>
             <button class="btn-ghost">Descargar Reporte</button>
           </div>
           <div style="height:320px; width:100%;"><canvas id="financeChart"></canvas></div>
        </div>

        <!-- 3. Tabla de Transacciones -->
        <div class="calendar-wrapper">
           <h3 style="margin-bottom:15px; color:var(--brand-deep)">√öltimas Transacciones</h3>
           <table style="width:100%; border-collapse:collapse;">
             <thead>
               <tr style="text-align:left; color:var(--text-light); border-bottom:2px solid #eee;">
                 <th style="padding:10px;">Fecha</th><th style="padding:10px;">Concepto</th><th style="padding:10px;">Monto</th>
               </tr>
             </thead>
             <tbody>
               <tr><td style="padding:12px; border-bottom:1px solid #eee;">05 Dic</td><td style="padding:12px; border-bottom:1px solid #eee;">Paquete 10 sesiones L√°ser</td><td style="padding:12px; border-bottom:1px solid #eee; color:var(--brand-sage); font-weight:bold;">+ S/ 800.00</td></tr>
               <tr><td style="padding:12px; border-bottom:1px solid #eee;">04 Dic</td><td style="padding:12px; border-bottom:1px solid #eee;">Compra Cremas Hidratantes</td><td style="padding:12px; border-bottom:1px solid #eee; color:#D0021B;">- S/ 250.00</td></tr>
             </tbody>
           </table>
        </div>
      </section>

      <!-- VISTA CLIENTES (Resumida) -->
      <section id="view-clientes" class="section-view">
        <div class="calendar-wrapper">
          <h3>Gesti√≥n de Clientes</h3>
          <p style="color:#888; margin-top:10px;">Funcionalidad disponible en m√≥dulo completo.</p>
        </div>
      </section>

    </main>
  </div>

  <!-- MODAL: AGREGAR CITA -->
  <div id="modal-container" class="overlay">
    <div class="modal-box">
       <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
         <h3 id="modal-title">T√≠tulo</h3>
         <button onclick="closeModal()" class="btn-ghost">‚úï</button>
       </div>
       
       <!-- Form Cita -->
       <div id="form-appointment" class="hidden">
         <form onsubmit="saveAppointment(event)">
           <input id="appt-client" class="input-std" placeholder="Nombre del Cliente" required>
           <div class="input-row">
             <input id="appt-day" type="number" min="1" max="31" class="input-std" placeholder="D√≠a (1-31)" required>
             <input id="appt-time" type="time" class="input-std" required>
           </div>
           <select id="appt-service" class="input-std">
             <option>Depilaci√≥n L√°ser</option>
             <option>Limpieza Facial</option>
             <option>Masaje Relajante</option>
           </select>
           <button type="submit" class="btn btn-primary" style="width:100%">Agendar Cita</button>
         </form>
       </div>

       <!-- Form Perfil -->
       <div id="form-profile" class="hidden">
          <form onsubmit="saveProfile(event)">
            <input id="prof-name" class="input-std" placeholder="Tu Nombre">
            <button type="submit" class="btn btn-primary" style="width:100%">Guardar Perfil</button>
          </form>
       </div>
    </div>
  </div>

  <script>
    // ================= DATOS & ESTADO =================
    let appointments = [
      { id: 1, day: 5, time: '10:00', client: 'Ana L√≥pez', service: 'Facial', vip: false },
      { id: 2, day: 5, time: '15:30', client: 'Carla Ruiz', service: 'Masaje', vip: true },
      { id: 3, day: 12, time: '09:00', client: 'Mar√≠a G.', service: 'L√°ser', vip: false }
    ];

    // ================= LOGIN =================
    function handleLogin(e) {
      e.preventDefault();
      document.getElementById('login-overlay').classList.remove('open');
      document.getElementById('app-layout').classList.remove('hidden');
      initDashboardCharts();
      initFinanceChart();
      renderCalendar();
    }

    // ================= NAVEGACI√ìN =================
    function goTab(id) {
      document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('nav-'+id).classList.add('active');
      document.querySelectorAll('.section-view').forEach(s => s.classList.remove('active'));
      document.getElementById('view-'+id).classList.add('active');
      
      const titles = {dashboard:'Dashboard', agenda:'Agenda', clientes:'Clientes', finanzas:'Reporte Financiero'};
      document.getElementById('page-title').innerText = titles[id];
    }

    // ================= CALENDARIO & CITAS =================
    function renderCalendar() {
      const grid = document.getElementById('calendar-grid');
      grid.innerHTML = '';
      
      // Headers
      ['Lun','Mar','Mie','Jue','Vie','Sab','Dom'].forEach(d => {
        grid.innerHTML += `<div class="cal-head">${d}</div>`;
      });

      // Days 1-31
      for(let i=1; i<=31; i++) {
        const dayDiv = document.createElement('div');
        dayDiv.className = 'cal-day';
        dayDiv.innerHTML = `<div class="cal-num">${i}</div>`;
        
        // Buscar citas para este d√≠a
        const dayAppts = appointments.filter(a => a.day == i);
        dayAppts.forEach(appt => {
          const tag = document.createElement('div');
          tag.className = appt.vip ? 'appt-tag vip' : 'appt-tag';
          tag.innerText = `${appt.time} ${appt.client}`;
          tag.title = appt.service;
          dayDiv.appendChild(tag);
        });

        grid.appendChild(dayDiv);
      }
    }

    function saveAppointment(e) {
      e.preventDefault();
      const client = document.getElementById('appt-client').value;
      const day = document.getElementById('appt-day').value;
      const time = document.getElementById('appt-time').value;
      const service = document.getElementById('appt-service').value;

      appointments.push({
        id: Date.now(),
        day: parseInt(day),
        time: time,
        client: client,
        service: service,
        vip: false
      });

      renderCalendar();
      closeModal();
      // Limpiar form
      e.target.reset();
      alert(`Cita agendada para el d√≠a ${day} a las ${time}`);
    }

    // ================= MODALES =================
    const modal = document.getElementById('modal-container');
    function openModal(type) {
      modal.classList.add('open');
      document.getElementById('form-appointment').classList.add('hidden');
      document.getElementById('form-profile').classList.add('hidden');

      if(type === 'appointment') {
        document.getElementById('modal-title').innerText = 'Nueva Cita';
        document.getElementById('form-appointment').classList.remove('hidden');
      } else if (type === 'profile') {
        document.getElementById('modal-title').innerText = 'Editar Perfil';
        document.getElementById('form-profile').classList.remove('hidden');
        document.getElementById('prof-name').value = document.getElementById('user-display-name').innerText;
      }
    }
    function closeModal() { modal.classList.remove('open'); }
    function saveProfile(e) {
      e.preventDefault();
      document.getElementById('user-display-name').innerText = document.getElementById('prof-name').value;
      closeModal();
    }

    // ================= GR√ÅFICOS (CHART.JS) =================
    function initDashboardCharts() {
      const colors = { deep: '#53583F', olive: '#B4B892', bronze: '#735D3A', sage: '#809571' };
      new Chart(document.getElementById('chartServices'), {
        type: 'doughnut',
        data: {
          labels: ['L√°ser', 'Facial', 'Masaje', 'U√±as'],
          datasets: [{
            data: [45, 25, 20, 10],
            backgroundColor: [colors.deep, colors.olive, colors.bronze, colors.sage],
            borderWidth: 0
          }]
        },
        options: { cutout: '75%', responsive: true, plugins: { legend: { position:'bottom', labels:{usePointStyle:true} } } }
      });
    }

    function initFinanceChart() {
      const ctx = document.getElementById('financeChart').getContext('2d');
      // Gradiente de relleno
      const gradient = ctx.createLinearGradient(0, 0, 0, 400);
      gradient.addColorStop(0, 'rgba(180, 184, 146, 0.6)'); // olive con opacidad
      gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'],
          datasets: [{
            label: 'Ingresos (S/)',
            data: [4500, 5200, 4800, 6100, 7500, 8400, 9100, 8800, 10500, 11200, 12450, 13100],
            borderColor: '#53583F',
            backgroundColor: gradient,
            borderWidth: 2,
            pointBackgroundColor: '#735D3A',
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true, grid: { color: '#f0f0f0' } }, x: { grid: { display: false } } }
        }
      });
    }

  </script>
</body>
</html>